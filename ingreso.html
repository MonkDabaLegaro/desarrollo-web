<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ingreso de Siniestro</title>
  <link rel="stylesheet" href="css/ingreso.css">
</head>
<body>
  <nav>
    <ul>
      <li><a href="index.html">Inicio</a></li>
      <li><a href="ingreso.html" class="active">Ingreso de Siniestro</a></li>
      <li><a href="consulta.html">Consulta de Estado</a></li>
      <li><a href="reporte.html">Reportes</a></li>
    </ul>
  </nav>

  <main>
    <h1>Ingreso de Siniestro</h1>
    <p>Completa los datos. La validación de póliza y creación de ficha están simuladas con datos locales.</p>

    <form id="form-siniestro">
      <div class="form-row">
        <div class="form-group">
          <label>RUT del Asegurado</label>
          <input type="text" id="rut" placeholder="12.345.678-5" required>
          <small class="hint">Ejemplo: 12345678-9</small>
        </div>
        <div class="form-group">
          <label>N° de Póliza</label>
          <input type="text" id="poliza" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Tipo de Daño</label>
          <select id="tipoDanio" required>
            <option value="">Selecciona...</option>
            <option>Colisión</option>
            <option>Robo</option>
            <option>Incendio</option>
          </select>
        </div>
        <div class="form-group">
          <label>Tipo de Vehículo</label>
          <select id="tipoVehiculo" required>
            <option value="">Selecciona...</option>
            <option>Auto</option>
            <option>Camioneta</option>
            <option>Moto</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Email de contacto</label>
          <input type="email" id="email" placeholder="correo@dominio.cl" required>
        </div>
        <div class="form-group">
          <label>Teléfono</label>
          <input type="tel" id="telefono" placeholder="+56 9 1234 5678" required>
        </div>
      </div>

      <div class="form-group file-upload">
        <label>Adjuntar Documento (simulado)</label>
        <div class="file-input-wrapper">
          <button type="button" class="file-button">Elegir archivo</button>
          <span class="file-text">No se ha seleccionado ningún archivo</span>
        </div>
        <small class="file-hint">Se almacenan solo los nombres de archivo en esta demo</small>
      </div>

      <div class="acciones">
        <button type="submit" class="btn-primario">Validar y crear ficha</button>
        <button type="reset" class="btn-secundario">Limpiar</button>
      </div>
    </form>
  </main>

  <!-- Scripts -->
  <script src="js/siniestro.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const formulario = document.getElementById("form-siniestro");

      formulario.addEventListener("submit", (e) => {
        e.preventDefault();

        const rut = document.getElementById("rut").value.trim();
        const numeroPoliza = document.getElementById("poliza").value.trim();
        const tipoDanio = document.getElementById("tipoDanio").value;
        const tipoVehiculo = document.getElementById("tipoVehiculo").value;
        const email = document.getElementById("email").value.trim();
        const telefono = document.getElementById("telefono").value.trim();

        if (!validarRUT(rut)) {
          alert("RUT inválido. Formato esperado: 12345678-9");
          return;
        }

        const datos = {
          rut,
          numeroPoliza,
          tipoSeguro: tipoDanio,
          vehiculo: tipoVehiculo,
          email,
          telefono
        };

        const nuevo = siniestroManager.crearSiniestro(datos);
        alert("✅ Siniestro creado con ID: " + nuevo.id);
        formulario.reset();
      });
    });
  </script>
</body>
</html>
